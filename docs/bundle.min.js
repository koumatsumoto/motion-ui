!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=2)}([function(e,t,a){"use strict";function n(e){for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a])}Object.defineProperty(t,"__esModule",{value:!0}),n(a(5)),n(a(7))},function(e,t,a){"use strict";function n(e){for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a])}Object.defineProperty(t,"__esModule",{value:!0}),n(a(10)),n(a(11)),n(a(12))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(3);a(27).runOnDocumentReady(()=>{const e=document.getElementById("debugboard"),t=t=>e.textContent=t;t("ready"),n.getActionStream().subscribe(e=>t(JSON.stringify(e)))})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(4),r=a(14),o=a(0),i=a(22),c=a(23),l=a(24),u=a(25);t.getMovementStream=(e=n.getDeviceOrientationStream(),t=r.getDeviceMotionStream())=>{const{bufferCount:a,map:l,withLatestFrom:u}=o.getRx().operators;let s=0;return t.pipe(a(4),u(e),l(([e,t])=>{const a=e.map(e=>e.rotationRate.gamma),n=i.combine(t.gamma,a),r=c.classify(n);return{sid:s++,data:r}}))},t.debug3=()=>{const{filter:e,map:a}=o.getRx().operators;return t.getMovementStream().pipe(e(e=>e.data.rate>0),a(e=>`${"up"===e.data.direction?"u":"d"}-${e.data.rate}: ${e.sid}`),o.withHistory(20),a(e=>e.reverse()))},t.getActionStream=()=>{const{Observable:e}=o.getRx(),{map:a}=o.getRx().operators;return new e(e=>{t.getMovementStream().pipe(o.withHistory(10),a(e=>{const t=e.map(e=>e.data),a=[e[0].sid,e[e.length-1].sid],n=l.checkHoldAndEntering(t);return n?{type:n,sid:a}:u.isQuickReverse(t.slice(-2))?{type:"quick reverse",sid:a}:{type:"moving",sid:a}})).subscribe(t=>{e.next(t)})})},t.getCommandHistoryStream=()=>{const{map:e}=o.getRx().operators;return t.getActionStream().pipe(o.withHistory(32),e(e=>e.map(e=>e.type).reverse()))},t.getLastCommandStream=()=>{const{distinctUntilChanged:e,map:a}=o.getRx().operators;return t.getActionStream().pipe(a(e=>e.type),e(),o.withHistory(8),a(e=>e.reverse()))},t.getCommandStream=()=>{const{Observable:e}=o.getRx(),{map:a}=o.getRx().operators;return new e(e=>{t.getActionStream().pipe(o.withHistory(6),a(e=>{}))})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),r=a(9);t.getDeviceOrientationEventStream=()=>{const e=new(0,n.getRx().Subject);return window.addEventListener("deviceorientation",t=>{e.next(t)}),e.asObservable()},t.getDeviceOrientationStream=()=>t.getDeviceOrientationEventStream().pipe(r.extract(),r.onlyEntire())},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(6);t.importRxJS=()=>new Promise((e,t)=>{window.rxjs&&e(window.rxjs),n.loadScript("https://cdnjs.cloudflare.com/ajax/libs/rxjs/7.0.0-alpha.0/rxjs.umd.min.js").then(()=>e(window.rxjs)).catch(t)}),t.getRx=()=>window.rxjs},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadScript=async e=>new Promise((t,a)=>{const n=document.createElement("script");n.setAttribute("src",e),n.addEventListener("load",e=>t(e),{once:!0}),n.addEventListener("error",e=>a(e),{once:!0}),document.body.appendChild(n)}),t.loadScripts=e=>Promise.all(e.map(e=>t.loadScript(e)))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var a in e)t.hasOwnProperty(a)||(t[a]=e[a])}(a(8))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(0);t.withHistory=e=>t=>{const{Observable:a}=n.getRx();return new a(a=>{const n=[];return t.subscribe({next(t){if(n.push(t),n.length>e)n.shift(),a.next([...n]);else{if(n.length<e)return;a.next([...n])}},error(e){a.error(e)},complete(){a.complete()}})})}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),r=a(1),o=a(13);t.extract=()=>e=>{const{map:t}=n.getRx().operators;return e.pipe(t(e=>({absolute:e.absolute,alpha:e.alpha,beta:e.beta,gamma:e.gamma})))},t.onlyEntire=()=>e=>{const{filter:t}=n.getRx().operators;return e.pipe(t(o.isEntireDeviceOrientation))},t.roundDecimal=()=>e=>{const{map:t}=n.getRx().operators;return e.pipe(t(e=>({absolute:e.absolute,alpha:r.roundToInt(e.alpha),beta:r.roundToInt(e.beta),gamma:r.roundToInt(e.gamma)})))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toFixed=(e,t=0)=>Number.parseFloat(e.toFixed(t))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.floorToInt=e=>Number.parseInt(e),t.roundToInt=e=>Math.round(e)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.within=(e,t,a)=>{if(t>a)throw new Error("invalid arguments");for(let n=t;n<a;n++)if(n<=e&&e<=a)return!0;return!1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEntireDeviceOrientation=e=>null!==e.alpha&&null!==e.beta&&null!==e.gamma},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(15);t.getDeviceMotionStream=n.getDeviceMotionStream},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),r=a(16);t.getDeviceMotionEventStream=()=>{const e=new(0,n.getRx().Subject);return window.addEventListener("devicemotion",t=>{e.next(t)}),e.asObservable()},t.getDeviceMotionStream=()=>t.getDeviceMotionEventStream().pipe(r.onlyEntire()),t.deprecatedGetDeviceMotionStream=(e={},a=t.getDeviceMotionStream())=>a.pipe(r.toInteger(e.precision),r.withChange(),r.asTuple(),r.normalizeByThreshold(e.threshold))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(0),r=a(17),o=a(18),i=a(19),c=a(20),l=a(21);t.withChange=()=>e=>{const{scan:t,skip:a}=n.getRx().operators;return e.pipe(t((e,t)=>null===e?{data:t,change:void 0}:{data:t,change:r.calculateMotionChange(e.data,t)},null),a(1))},t.toAverage=(e=4)=>t=>{const{bufferCount:a,map:r}=n.getRx().operators;return t.pipe(a(e),r(e=>o.calculateMotionAverage(e)))},t.toInteger=(e=8)=>t=>{const{map:a}=n.getRx().operators;return t.pipe(a(t=>i.toInt(t,e)))},t.asTuple=()=>e=>{const{map:t}=n.getRx().operators;return e.pipe(t(r.makeTuple))},t.normalizeByThreshold=e=>t=>{const{map:a}=n.getRx().operators;return t.pipe(a(t=>c.normalize(t,e)))},t.onlyEntire=()=>e=>{const{filter:t}=n.getRx().operators;return e.pipe(t(l.isEntireDeviceMotion))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(1);t.calculateMotionChange=(e,t)=>({acceleration:{x:t.acceleration.x-e.acceleration.x,y:t.acceleration.y-e.acceleration.y,z:t.acceleration.z-e.acceleration.z},accelerationIncludingGravity:{x:t.accelerationIncludingGravity.x-e.accelerationIncludingGravity.x,y:t.accelerationIncludingGravity.y-e.accelerationIncludingGravity.y,z:t.accelerationIncludingGravity.z-e.accelerationIncludingGravity.z},rotationRate:{alpha:t.rotationRate.alpha-e.rotationRate.alpha,beta:t.rotationRate.beta-e.rotationRate.beta,gamma:t.rotationRate.gamma-e.rotationRate.gamma}});const r=(e,t,a)=>n.floorToInt((e-t)/a);t.makeTuple=e=>({acceleration:{x:[e.data.acceleration.x,e.change.acceleration.x],y:[e.data.acceleration.y,e.change.acceleration.y],z:[e.data.acceleration.z,e.change.acceleration.z]},accelerationIncludingGravity:{x:[e.data.accelerationIncludingGravity.x,e.change.accelerationIncludingGravity.x],y:[e.data.accelerationIncludingGravity.y,e.change.accelerationIncludingGravity.y],z:[e.data.accelerationIncludingGravity.z,e.change.accelerationIncludingGravity.z]},rotationRate:{alpha:[e.data.rotationRate.alpha,e.change.rotationRate.alpha],beta:[e.data.rotationRate.beta,e.change.rotationRate.beta],gamma:[e.data.rotationRate.gamma,e.change.rotationRate.gamma]}}),t.makeChange=(e,t)=>({acceleration:{x:[e.acceleration.x,t.acceleration.x],y:[e.acceleration.y,t.acceleration.y],z:[e.acceleration.z,t.acceleration.z]},accelerationIncludingGravity:{x:[e.accelerationIncludingGravity.x,t.accelerationIncludingGravity.x],y:[e.accelerationIncludingGravity.y,t.accelerationIncludingGravity.y],z:[e.accelerationIncludingGravity.z,t.accelerationIncludingGravity.z]},rotationRate:{alpha:[e.rotationRate.alpha,t.rotationRate.alpha],beta:[e.rotationRate.beta,t.rotationRate.beta],gamma:[e.rotationRate.gamma,t.rotationRate.gamma]}}),t.getChangePerMillisecond=(e,t)=>({acceleration:{x:r(t.acceleration.x,e.acceleration.x,t.interval),y:r(t.acceleration.y,e.acceleration.y,t.interval),z:r(t.acceleration.z,e.acceleration.z,t.interval)},accelerationIncludingGravity:{x:r(t.accelerationIncludingGravity.x,e.accelerationIncludingGravity.x,t.interval),y:r(t.accelerationIncludingGravity.y,e.accelerationIncludingGravity.y,t.interval),z:r(t.accelerationIncludingGravity.z,e.accelerationIncludingGravity.z,t.interval)},rotationRate:{alpha:r(t.rotationRate.alpha,e.rotationRate.alpha,t.interval),beta:r(t.rotationRate.beta,e.rotationRate.beta,t.interval),gamma:r(t.rotationRate.gamma,e.rotationRate.gamma,t.interval)}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateMotionAverage=e=>{if(e.length<1)return null;const t=e.length,a=e.reduce((e,t)=>({acceleration:{x:e.acceleration.x+t.acceleration.x,y:e.acceleration.y+t.acceleration.y,z:e.acceleration.z+t.acceleration.z},accelerationIncludingGravity:{x:e.accelerationIncludingGravity.x+t.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y+t.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z+t.accelerationIncludingGravity.z},rotationRate:{alpha:e.rotationRate.alpha+t.rotationRate.alpha,beta:e.rotationRate.beta+t.rotationRate.beta,gamma:e.rotationRate.gamma+t.rotationRate.gamma}}));return{acceleration:{x:a.acceleration.x/t,y:a.acceleration.y/t,z:a.acceleration.z/t},accelerationIncludingGravity:{x:a.accelerationIncludingGravity.x/t,y:a.accelerationIncludingGravity.y/t,z:a.accelerationIncludingGravity.z/t},rotationRate:{alpha:a.rotationRate.alpha/t,beta:a.rotationRate.beta/t,gamma:a.rotationRate.gamma/t}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=(e,t)=>Number.parseInt((e*t).toFixed(0));t.toInt=(e,t=8)=>{const a=10**t;return{interval:e.interval,acceleration:{x:n(e.acceleration.x,a),y:n(e.acceleration.y,a),z:n(e.acceleration.z,a)},accelerationIncludingGravity:{x:n(e.accelerationIncludingGravity.x,a),y:n(e.accelerationIncludingGravity.y,a),z:n(e.accelerationIncludingGravity.z,a)},rotationRate:{alpha:n(e.rotationRate.alpha,a),beta:n(e.rotationRate.beta,a),gamma:n(e.rotationRate.gamma,a)}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(1),r={acceleration:1e6,accelerationIncludingGravity:1e6,rotationRate:1e7},o=(e,t)=>[n.roundToInt(e[0]/t),n.roundToInt(e[1]/t)];t.normalize=(e,t=r)=>({acceleration:{x:o(e.acceleration.x,t.acceleration),y:o(e.acceleration.y,t.acceleration),z:o(e.acceleration.z,t.acceleration)},accelerationIncludingGravity:{x:o(e.accelerationIncludingGravity.x,t.accelerationIncludingGravity),y:o(e.accelerationIncludingGravity.y,t.accelerationIncludingGravity),z:o(e.accelerationIncludingGravity.z,t.accelerationIncludingGravity)},rotationRate:{alpha:o(e.rotationRate.alpha,t.rotationRate),beta:o(e.rotationRate.beta,t.rotationRate),gamma:o(e.rotationRate.gamma,t.rotationRate)}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEntireDeviceMotion=e=>{const t=e.acceleration;if(null===t||null===t.x||null===t.y||null===t.z)return!1;const a=e.accelerationIncludingGravity;if(null===a||null===a.x||null===a.y||null===a.z)return!1;const n=e.rotationRate;return null!==n&&null!==n.alpha&&null!==n.beta&&null!==n.gamma}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(1);t.combine=(e,t)=>{if(t.length<2)throw new Error("bad impl");const a=t[0],r=t[t.length-1],o={orientation:e>=0?"up":"down",count:t.length,increase:0,decrease:0,nochange:0,first:a,last:r,max:t[0],min:t[0],avg:t[0]};let i=0;for(let e=1;e<t.length;e++){const a=t[e-1],n=t[e];n>a?o.increase++:n<a?o.decrease++:o.nochange++,i+=n,o.max=Math.max(o.max,n),o.min=Math.min(o.min,n)}return o.avg=i/o.count,o.avg=n.roundToInt(o.avg),o.min=n.roundToInt(o.min),o.max=n.roundToInt(o.max),o.first=n.roundToInt(o.first),o.last=n.roundToInt(o.last),o}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultThreshold={veryHigh:120,high:90,tap:38,low:20,round:10};const n=(e,t)=>e>t.veryHigh?5:e>t.high?4:e>t.tap?3:e>t.low?2:e>t.round?1:0;t.classify=(e,a=t.defaultThreshold)=>{if(e.first<e.last){const t=n(e.last-e.first,a),r=e.count===e.increase;return{orientation:e.orientation,direction:"up",rate:t,align:r}}if(e.first>e.last){const t=n(e.first-e.last,a),r=e.count===e.decrease;return{orientation:e.orientation,direction:"down",rate:t,align:r}}{let t,a;return e.first>0?(t=e.max-e.first,a=e.min>0?e.first-e.min:Math.abs(e.min-e.first)):(t=e.max<0?Math.abs(e.first+e.max):e.max-e.first,a=Math.abs(e.min+e.first)),{orientation:e.orientation,direction:t>a?"up":"down",rate:0,align:e.first===e.max&&e.first===e.min}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stoppingCount=4,t.shortHoldCount=7,t.motionEnteringCount=8,t.longHoldCount=10;const n=(e,t)=>{if(e.length!==t)return!1;for(let a=0;a<t;a++)if(0!==e[a].rate)return!1;return!0};t.isShortHold=e=>n(e,t.shortHoldCount),t.checkEnterMotionType=e=>{if(e.length<t.motionEnteringCount)return null;if(t.isShortHold(e.slice(-t.shortHoldCount))){if(e[e.length-1].rate>1)return"quick start";if(e[e.length-1].rate>0)return"slow start"}return null},t.checkHoldAndEntering=e=>{const a=(e=>{let a=0;for(let t=e.length-1;t>=0&&0===e[t].rate;t--)a++;return a>=t.longHoldCount?"long hold":a>=t.shortHoldCount?"short hold":a>=t.stoppingCount?"stopping":null})(e);return a||t.checkEnterMotionType(e)},t.isLongHold=e=>n(e,t.longHoldCount),t.isStopping=e=>n(e,t.stoppingCount)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=a(26);t.quickReverseCount=2,t.isQuickReverse=e=>{if(e.length<t.quickReverseCount)return!1;const a=n.simplifyMovements(e),r=a[0],o=a[1];return!(r.rate<3)&&!(o.rate>0)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simplifyMovements=e=>{if(e.length<1)return[];let t;return e.map(e=>(void 0===t&&0!==e.rate&&(t=e.direction),void 0===t||e.direction===t?{rate:e.rate,align:e.align}:{rate:0===e.rate?0:-e.rate,align:e.align}))},t.contain=(e,t)=>{for(let a=0;a<=e.length-t.length;a++){let n=!1;for(let r=0;r<t.length;r++)if(t[r]!==e[a+r]){n=!0;break}if(!n)return!0}return!1}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runOnDocumentReady=e=>{"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",()=>e())}}]);