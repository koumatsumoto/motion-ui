!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=3)}([function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(7)),r(n(9))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.inputCount=10,t.longHoldCount=t.inputCount,t.shortHoldCount=7,t.stoppingCount=3,t.startingIndex=t.inputCount-t.stoppingCount,t.firstMoveIndex=t.inputCount-t.stoppingCount,t.secondMoveIndex=t.inputCount-2,t.thirdMoveIndex=t.inputCount-1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(4).debug()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),o=n(6);t.debug=()=>r.runOnDocumentReady(()=>{const e=document.getElementById("left-top"),t=document.getElementById("left-bot"),n=document.getElementById("right-top"),r=document.getElementById("right-bot"),i=(o,i)=>{let a;switch(i){case"left-top":a=e;break;case"left-bot":a=t;break;case"right-top":a=n;break;case"right-bot":a=r;break;default:a=e}a.textContent=o};let a,c,u;o.getLastCommandStream().subscribe(e=>a=e),o.getCommandHistoryStream().subscribe(e=>c=e),o.debug3().subscribe(e=>u=e);const s=()=>{a&&i(JSON.stringify(a,null,2),"left-top"),c&&i(JSON.stringify(c,null,2),"left-bot"),u&&i(JSON.stringify(u,null,2),"right-top"),window.requestAnimationFrame(s)};s()})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runOnDocumentReady=e=>{"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",()=>e())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(11),i=n(2);t.debug3=()=>{const{filter:e,map:t}=r.getRx().operators;return i.getMotionUnitStream().pipe(e(e=>e.data.rate>0),t(e=>`${"up"===e.data.direction?"u":"d"}-${e.data.rate}: ${e.sid}`),r.withHistory(20),t(e=>e.reverse()))},t.getCommandHistoryStream=()=>{const{map:e}=r.getRx().operators;return o.getMovementStream().pipe(r.withHistory(32),e(e=>e.map(e=>e.type).reverse()))},t.getLastCommandStream=()=>{const{distinctUntilChanged:e,map:t}=r.getRx().operators;return o.getMovementStream().pipe(t(e=>e.type),e(),r.withHistory(8),t(e=>e.reverse()))},t.getCommandStream=()=>{const{Observable:e}=r.getRx(),{map:t}=r.getRx().operators;return new e(e=>{o.getMovementStream().pipe(r.withHistory(6),t(e=>{}))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(8);t.importRxJS=()=>new Promise((e,t)=>{window.rxjs&&e(window.rxjs),r.loadScript("https://cdnjs.cloudflare.com/ajax/libs/rxjs/7.0.0-alpha.0/rxjs.umd.min.js").then(()=>e(window.rxjs)).catch(t)}),t.getRx=()=>window.rxjs},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadScript=async e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.addEventListener("load",e=>t(e),{once:!0}),r.addEventListener("error",e=>n(e),{once:!0}),document.body.appendChild(r)}),t.loadScripts=e=>Promise.all(e.map(e=>t.loadScript(e)))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(10))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0);t.withHistory=e=>t=>{const{Observable:n}=r.getRx();return new n(n=>{const r=[];return t.subscribe({next(t){if(r.push(t),r.length>e)r.shift(),n.next([...r]);else{if(r.length<e)return;n.next([...r])}},error(e){n.error(e)},complete(){n.complete()}})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(12))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(2),i=n(1),a=n(29);t.getMovementStream=()=>{const{Observable:e}=r.getRx(),{map:t}=r.getRx().operators;return new e(e=>{o.getMotionUnitStream().pipe(r.withHistory(i.inputCount),t(e=>{const t=e.map(e=>e.data),n=[e[0].sid,e[e.length-1].sid];return{type:a.detectMovement(t),sid:n}})).subscribe(t=>{e.next(t)})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(14),o=n(17),i=n(0),a=n(23),c=n(28);t.getMotionUnitStream=(e=r.getDeviceOrientationStream(),t=o.getDeviceMotionStream())=>{const{bufferCount:n,map:u,withLatestFrom:s}=i.getRx().operators;let l=0;return t.pipe(n(4),s(e),u(([e,t])=>{const n=e.map(e=>e.rotationRate.gamma),r=a.summarize(t.gamma,n),o=c.unify(r);return{sid:l++,data:o}}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(15);t.getDeviceOrientationStream=(e=(()=>{const e=new(0,r.getRx().Subject);return window.addEventListener("deviceorientation",t=>{e.next(t)}),e.asObservable()})())=>e.pipe(o.extract(),o.onlyEntire())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(16);t.extract=()=>e=>{const{map:t}=r.getRx().operators;return e.pipe(t(e=>({absolute:e.absolute,alpha:e.alpha,beta:e.beta,gamma:e.gamma})))},t.onlyEntire=()=>e=>{const{filter:t}=r.getRx().operators;return e.pipe(t(o.isEntireDeviceOrientation))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEntireDeviceOrientation=e=>null!==e.alpha&&null!==e.beta&&null!==e.gamma},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18);t.getDeviceMotionStream=r.getDeviceMotionStream},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(19);t.getDeviceMotionStream=(e=(()=>{const e=new(0,r.getRx().Subject);return window.addEventListener("devicemotion",t=>{e.next(t)}),e.asObservable()})())=>e.pipe(o.onlyEntire())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(0),o=n(20),i=n(21),a=n(22);t.withChange=()=>e=>{const{scan:t,skip:n}=r.getRx().operators;return e.pipe(t((e,t)=>null===e?{data:t,change:void 0}:{data:t,change:o.getDifference(e.data,t)},null),n(1))},t.toAverage=(e=4)=>t=>{const{bufferCount:n,map:o}=r.getRx().operators;return t.pipe(n(e),o(e=>i.calculateAverage(e)))},t.onlyEntire=()=>e=>{const{filter:t}=r.getRx().operators;return e.pipe(t(a.isEntireDeviceMotion))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDifference=(e,t)=>({acceleration:{x:t.acceleration.x-e.acceleration.x,y:t.acceleration.y-e.acceleration.y,z:t.acceleration.z-e.acceleration.z},accelerationIncludingGravity:{x:t.accelerationIncludingGravity.x-e.accelerationIncludingGravity.x,y:t.accelerationIncludingGravity.y-e.accelerationIncludingGravity.y,z:t.accelerationIncludingGravity.z-e.accelerationIncludingGravity.z},rotationRate:{alpha:t.rotationRate.alpha-e.rotationRate.alpha,beta:t.rotationRate.beta-e.rotationRate.beta,gamma:t.rotationRate.gamma-e.rotationRate.gamma}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateAverage=e=>{if(e.length<1)return null;const t=e.length,n=e.reduce((e,t)=>({acceleration:{x:e.acceleration.x+t.acceleration.x,y:e.acceleration.y+t.acceleration.y,z:e.acceleration.z+t.acceleration.z},accelerationIncludingGravity:{x:e.accelerationIncludingGravity.x+t.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y+t.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z+t.accelerationIncludingGravity.z},rotationRate:{alpha:e.rotationRate.alpha+t.rotationRate.alpha,beta:e.rotationRate.beta+t.rotationRate.beta,gamma:e.rotationRate.gamma+t.rotationRate.gamma}}));return{acceleration:{x:n.acceleration.x/t,y:n.acceleration.y/t,z:n.acceleration.z/t},accelerationIncludingGravity:{x:n.accelerationIncludingGravity.x/t,y:n.accelerationIncludingGravity.y/t,z:n.accelerationIncludingGravity.z/t},rotationRate:{alpha:n.rotationRate.alpha/t,beta:n.rotationRate.beta/t,gamma:n.rotationRate.gamma/t}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEntireDeviceMotion=e=>{const t=e.acceleration;if(null===t||null===t.x||null===t.y||null===t.z)return!1;const n=e.accelerationIncludingGravity;if(null===n||null===n.x||null===n.y||null===n.z)return!1;const r=e.rotationRate;return null!==r&&null!==r.alpha&&null!==r.beta&&null!==r.gamma}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(24);t.summarize=(e,t)=>{if(t.length<2)throw new Error("bad impl");const n=t[0],o=t[t.length-1],i={orientation:e>=0?"up":"down",count:t.length,increase:0,decrease:0,nochange:0,first:n,last:o,max:t[0],min:t[0],avg:t[0]};let a=0;for(let e=1;e<t.length;e++){const n=t[e-1],r=t[e];r>n?i.increase++:r<n?i.decrease++:i.nochange++,a+=r,i.max=Math.max(i.max,r),i.min=Math.min(i.min,r)}return i.avg=a/i.count,i.avg=r.roundToInt(i.avg),i.min=r.roundToInt(i.min),i.max=r.roundToInt(i.max),i.first=r.roundToInt(i.first),i.last=r.roundToInt(i.last),i}},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(25)),r(n(26)),r(n(27))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toFixed=(e,t=0)=>Number.parseFloat(e.toFixed(t))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.floorToInt=e=>Number.parseInt(e),t.roundToInt=e=>Math.round(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.within=(e,t,n)=>{if(t>n)throw new Error("invalid arguments");for(let r=t;r<n;r++)if(r<=e&&e<=n)return!0;return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultThreshold={veryHigh:120,high:90,tap:38,low:20,round:10};const r=(e,t)=>e>t.veryHigh?5:e>t.high?4:e>t.tap?3:e>t.low?2:e>t.round?1:0;t.unify=(e,n=t.defaultThreshold)=>{if(e.first<e.last){const t=r(e.last-e.first,n),o=e.count===e.increase;return{orientation:e.orientation,direction:"up",rate:t,align:o}}if(e.first>e.last){const t=r(e.first-e.last,n),o=e.count===e.decrease;return{orientation:e.orientation,direction:"down",rate:t,align:o}}{let t,n;return e.first>0?(t=e.max-e.first,n=e.min>0?e.first-e.min:Math.abs(e.min-e.first)):(t=e.max<0?Math.abs(e.first+e.max):e.max-e.first,n=Math.abs(e.min+e.first)),{orientation:e.orientation,direction:t>n?"up":"down",rate:0,align:e.first===e.max&&e.first===e.min}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(30),o=n(31),i=n(32);t.detectMovement=e=>r.isStoppingMovementInput(e)?o.detectStopAndStartMovement(e):i.detectMovingMovement(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isStoppingMovementInput=e=>10===e.length&&0===e[e.length-1].rate&&0===e[e.length-2].rate},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1);t.detectStopAndStartMovement=e=>{if(0!==e[r.startingIndex].rate)return e[r.startingIndex].rate>1?"quick start":"slow start";let t=0;for(let n=e.length-1;0<=n&&0===e[n].rate;n--)t++;return t>=r.longHoldCount?"long hold":t>=r.shortHoldCount?"short hold":"stopping"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(1),o=n(33);t.detectMovingMovement=e=>{const t=o.simplifyMovements([e[r.firstMoveIndex],e[r.secondMoveIndex],e[r.thirdMoveIndex]]),n=t[0],i=t[1],a=t[2];return(0===n.rate||1===n.rate)&&3<=Math.abs(i.rate)&&3<=Math.abs(a.rate-i.rate)?0===a.rate?"just return":"over return":"moving"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.simplifyMovements=e=>{if(e.length<1)return[];let t;return e.map(e=>(void 0===t&&0!==e.rate&&(t=e.direction),void 0===t||e.direction===t?{rate:e.rate,align:e.align}:{rate:0===e.rate?0:-e.rate,align:e.align}))},t.contain=(e,t)=>{for(let n=0;n<=e.length-t.length;n++){let r=!1;for(let o=0;o<t.length;o++)if(t[o]!==e[n+o]){r=!0;break}if(!r)return!0}return!1}}]);